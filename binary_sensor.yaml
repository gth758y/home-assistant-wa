# Binary sensors
  - platform: threshold
    name: "Is It Dark"
    lower: 375
    hysteresis: 50
    entity_id: sensor.living_room_light_level
    
  - platform: iss
    
  # - platform: threshold
    # name: "Darkness Threshold for Lights Off"
    # upper: 400
    # entity_id: sensor.living_room_light_level

  - platform: template
    sensors:
      tyler_home:
        value_template: >-
          {{ states('sensor.tyler_home_occupancy_confidence')|float > 10 }}

  - platform: template
    sensors:
      amy_home:
        value_template: >-
          {{ states('sensor.amy_home_occupancy_confidence')|float > 10 }}

  - platform: template
    sensors:
      anybody_home:
        value_template: >-
          {{ is_state('binary_sensor.tyler_home', 'on')
             or is_state('binary_sensor.amy_home', 'on') }}
             
  - platform: template
    sensors:
      house_asleep:
        value_template: >-
          {% set hour = states('sensor.time').split(':')[0]|int %}
          {{ (is_state('binary_sensor.anybody_home', 'off') and (hour > 22 or hour < 6))
              or (is_state('binary_sensor.tyler_home', 'on') and is_state('binary_sensor.amy_home', 'off') and is_state('input_select.tyler_status', 'sleeping'))
              or (is_state('binary_sensor.amy_home', 'on') and is_state('binary_sensor.tyler_home', 'off') and is_state('input_select.amy_status', 'sleeping'))
              or (is_state('binary_sensor.tyler_home', 'on') and is_state('binary_sensor.amy_home', 'on') and is_state('input_select.tyler_status', 'sleeping') and is_state('input_select.amy_status', 'sleeping')) }}
              
  - platform: mqtt
    name: "Garage Door - Tyler"
    state_topic: "garage/door/1/status"
    payload_on: "open"
    payload_off: "closed"
    availability_topic: "GarHAge/availability"
    device_class: opening
    qos: 0

  - platform: mqtt
    name: "Garage Door - Amy"
    state_topic: "garage/door/2/status"
    payload_on: "open"
    payload_off: "closed"
    availability_topic: "GarHAge/availability"
    device_class: opening
    qos: 0

  - platform: mqtt
    name: "Garage Door - Bikes"
    state_topic: "garage/door/3/status"
    payload_on: "open"
    payload_off: "closed"
    availability_topic: "GarHAge/availability"
    device_class: opening
    qos: 0

  - platform: template
    sensors:
      garage_open:
        value_template: >-
          {{ is_state('binary_sensor.garage_door__amy', 'on')
             or is_state('binary_sensor.garage_door__bikes', 'on')
             or is_state('binary_sensor.garage_door__tyler', 'on')
          }}
          
          